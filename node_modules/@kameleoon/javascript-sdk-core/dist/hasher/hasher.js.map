{"version":3,"file":"hasher.js","names":["_cryptoJs","require","Hasher","obtainExperimentHashDouble","visitorCode","campaignId","respoolTime","respoolTimeString","length","forEach","respoolObject","String","value","calculateHash","obtainFeatureFlagHashDouble","suffix","seed","hashDigest","SHA256","toString","parseInt","Math","pow","exports"],"sources":["../../src/hasher/hasher.ts"],"sourcesContent":["import { SHA256 } from 'crypto-js';\nimport {\n  ObtainExperimentHashDoubleParamsType,\n  ObtainFeatureFlagHashDoubleParamsType,\n} from './types';\n\nexport class Hasher {\n  static obtainExperimentHashDouble({\n    visitorCode,\n    campaignId,\n    respoolTime,\n  }: ObtainExperimentHashDoubleParamsType): number {\n    let respoolTimeString = '';\n\n    if (respoolTime.length) {\n      respoolTime.forEach((respoolObject) => {\n        respoolTimeString += String(respoolObject.value);\n      });\n    }\n\n    return this.calculateHash(visitorCode + campaignId + respoolTimeString);\n  }\n\n  static obtainFeatureFlagHashDouble({\n    visitorCode,\n    campaignId,\n    respoolTime,\n  }: ObtainFeatureFlagHashDoubleParamsType): number {\n    let suffix = '';\n\n    if (respoolTime) {\n      suffix += String(respoolTime);\n    }\n\n    return this.calculateHash(visitorCode + campaignId + suffix);\n  }\n\n  // --- Note ---\n  // `hashDouble` is a seeded pseudo-random number between 0 and 1\n  // used for deciding what variation to assign\n  // `calculateHash` algorithm is consistent between every SDK\n  // and will always provide same pseudo-random value for the same input parameters\n  static calculateHash(seed: string): number {\n    const hashDigest = SHA256(seed).toString();\n\n    return parseInt(hashDigest, 16) / Math.pow(2, 256);\n  }\n}\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,OAAA;AAMO,MAAMC,MAAM,CAAC;EAClB,OAAOC,0BAA0BA,CAAC;IAChCC,WAAW;IACXC,UAAU;IACVC;EACoC,CAAC,EAAU;IAC/C,IAAIC,iBAAiB,GAAG,EAAE;IAE1B,IAAID,WAAW,CAACE,MAAM,EAAE;MACtBF,WAAW,CAACG,OAAO,CAAEC,aAAa,IAAK;QACrCH,iBAAiB,IAAII,MAAM,CAACD,aAAa,CAACE,KAAK,CAAC;MAClD,CAAC,CAAC;IACJ;IAEA,OAAO,IAAI,CAACC,aAAa,CAACT,WAAW,GAAGC,UAAU,GAAGE,iBAAiB,CAAC;EACzE;EAEA,OAAOO,2BAA2BA,CAAC;IACjCV,WAAW;IACXC,UAAU;IACVC;EACqC,CAAC,EAAU;IAChD,IAAIS,MAAM,GAAG,EAAE;IAEf,IAAIT,WAAW,EAAE;MACfS,MAAM,IAAIJ,MAAM,CAACL,WAAW,CAAC;IAC/B;IAEA,OAAO,IAAI,CAACO,aAAa,CAACT,WAAW,GAAGC,UAAU,GAAGU,MAAM,CAAC;EAC9D;;EAEA;EACA;EACA;EACA;EACA;EACA,OAAOF,aAAaA,CAACG,IAAY,EAAU;IACzC,MAAMC,UAAU,GAAG,IAAAC,gBAAM,EAACF,IAAI,CAAC,CAACG,QAAQ,EAAE;IAE1C,OAAOC,QAAQ,CAACH,UAAU,EAAE,EAAE,CAAC,GAAGI,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC;EACpD;AACF;AAACC,OAAA,CAAArB,MAAA,GAAAA,MAAA"}