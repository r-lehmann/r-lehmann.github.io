{"version":3,"file":"exclusiveExperimentCondition.js","names":["_tsRes","require","_defineProperty","obj","key","value","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","ExclusiveExperimentCondition","constructor","isInclude","inverseResult","evaluate","experimentId","variationData","keys","isEmpty","length","isExclusive","isSatisfied","Ok","exports"],"sources":["../../../src/targeting/conditions/exclusiveExperimentCondition.ts"],"sourcesContent":["import { Ok, Result } from 'ts-res';\nimport { KameleoonError } from '../../kameleoonError';\nimport { EvaluationDataType } from '../types';\nimport { ConditionDataType, ICondition } from './types';\n\nexport class ExclusiveExperimentCondition implements ICondition {\n  private inverseResult: boolean;\n\n  constructor({ isInclude }: ConditionDataType) {\n    this.inverseResult = !(isInclude ?? true);\n  }\n\n  evaluate({\n    experimentId,\n    variationData,\n  }: EvaluationDataType): Result<boolean, KameleoonError> {\n    const keys = Object.keys(variationData);\n    const isEmpty = !keys.length;\n    // --- Note ---\n    // Meaning the next variation assignment won't add new experiment\n    // but rather overwrite the existing one\n    const isExclusive = keys.length === 1 && keys[0] === String(experimentId);\n\n    const isSatisfied = isEmpty || isExclusive;\n\n    return Ok(this.inverseResult ? !isSatisfied : isSatisfied);\n  }\n}\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,OAAA;AAAoC,SAAAC,gBAAAC,GAAA,EAAAC,GAAA,EAAAC,KAAA,IAAAD,GAAA,GAAAE,cAAA,CAAAF,GAAA,OAAAA,GAAA,IAAAD,GAAA,IAAAI,MAAA,CAAAC,cAAA,CAAAL,GAAA,EAAAC,GAAA,IAAAC,KAAA,EAAAA,KAAA,EAAAI,UAAA,QAAAC,YAAA,QAAAC,QAAA,oBAAAR,GAAA,CAAAC,GAAA,IAAAC,KAAA,WAAAF,GAAA;AAAA,SAAAG,eAAAM,GAAA,QAAAR,GAAA,GAAAS,YAAA,CAAAD,GAAA,2BAAAR,GAAA,gBAAAA,GAAA,GAAAU,MAAA,CAAAV,GAAA;AAAA,SAAAS,aAAAE,KAAA,EAAAC,IAAA,eAAAD,KAAA,iBAAAA,KAAA,kBAAAA,KAAA,MAAAE,IAAA,GAAAF,KAAA,CAAAG,MAAA,CAAAC,WAAA,OAAAF,IAAA,KAAAG,SAAA,QAAAC,GAAA,GAAAJ,IAAA,CAAAK,IAAA,CAAAP,KAAA,EAAAC,IAAA,2BAAAK,GAAA,sBAAAA,GAAA,YAAAE,SAAA,4DAAAP,IAAA,gBAAAF,MAAA,GAAAU,MAAA,EAAAT,KAAA;AAK7B,MAAMU,4BAA4B,CAAuB;EAG9DC,WAAWA,CAAC;IAAEC;EAA6B,CAAC,EAAE;IAAAzB,eAAA;IAC5C,IAAI,CAAC0B,aAAa,GAAG,EAAED,SAAS,IAAI,IAAI,CAAC;EAC3C;EAEAE,QAAQA,CAAC;IACPC,YAAY;IACZC;EACkB,CAAC,EAAmC;IACtD,MAAMC,IAAI,GAAGzB,MAAM,CAACyB,IAAI,CAACD,aAAa,CAAC;IACvC,MAAME,OAAO,GAAG,CAACD,IAAI,CAACE,MAAM;IAC5B;IACA;IACA;IACA,MAAMC,WAAW,GAAGH,IAAI,CAACE,MAAM,KAAK,CAAC,IAAIF,IAAI,CAAC,CAAC,CAAC,KAAKlB,MAAM,CAACgB,YAAY,CAAC;IAEzE,MAAMM,WAAW,GAAGH,OAAO,IAAIE,WAAW;IAE1C,OAAO,IAAAE,SAAE,EAAC,IAAI,CAACT,aAAa,GAAG,CAACQ,WAAW,GAAGA,WAAW,CAAC;EAC5D;AACF;AAACE,OAAA,CAAAb,4BAAA,GAAAA,4BAAA"}