{"version":3,"file":"storage.js","names":["_javascriptSdkCore","require","_defineProperty","obj","key","value","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","StorageConstructor","initialize","storage","Storage","exports","constructor","storageKey","read","data","localStorage","getItem","Err","KameleoonError","KameleoonException","StorageRead","Ok","write","setItem","err","StorageWrite"],"sources":["../src/storage.ts"],"sourcesContent":["import {\n  Ok,\n  Err,\n  Result,\n  KameleoonError,\n  IExternalStorage,\n  KameleoonException,\n  KameleoonStorageKey,\n  IExternalStorageConstructor,\n} from '@kameleoon/javascript-sdk-core';\n\nexport class StorageConstructor implements IExternalStorageConstructor {\n  public initialize(key: KameleoonStorageKey): IExternalStorage {\n    const storage = new Storage(key);\n\n    return storage;\n  }\n}\n\nclass Storage implements IExternalStorage {\n  private storageKey: KameleoonStorageKey;\n\n  constructor(key: KameleoonStorageKey) {\n    this.storageKey = key;\n  }\n\n  get key(): KameleoonStorageKey {\n    return this.storageKey;\n  }\n\n  public read(): Result<string, KameleoonError> {\n    const data = localStorage.getItem(this.storageKey);\n\n    if (!data) {\n      return Err(\n        new KameleoonError(KameleoonException.StorageRead, this.storageKey),\n      );\n    }\n\n    return Ok(data);\n  }\n\n  public write(data: string): Result<void, KameleoonError> {\n    try {\n      localStorage.setItem(this.storageKey, data);\n\n      return Ok();\n    } catch (err) {\n      return Err(new KameleoonError(KameleoonException.StorageWrite, err));\n    }\n  }\n}\n"],"mappings":";;;;;;AAAA,IAAAA,kBAAA,GAAAC,OAAA;AASwC,SAAAC,gBAAAC,GAAA,EAAAC,GAAA,EAAAC,KAAA,IAAAD,GAAA,GAAAE,cAAA,CAAAF,GAAA,OAAAA,GAAA,IAAAD,GAAA,IAAAI,MAAA,CAAAC,cAAA,CAAAL,GAAA,EAAAC,GAAA,IAAAC,KAAA,EAAAA,KAAA,EAAAI,UAAA,QAAAC,YAAA,QAAAC,QAAA,oBAAAR,GAAA,CAAAC,GAAA,IAAAC,KAAA,WAAAF,GAAA;AAAA,SAAAG,eAAAM,GAAA,QAAAR,GAAA,GAAAS,YAAA,CAAAD,GAAA,2BAAAR,GAAA,gBAAAA,GAAA,GAAAU,MAAA,CAAAV,GAAA;AAAA,SAAAS,aAAAE,KAAA,EAAAC,IAAA,eAAAD,KAAA,iBAAAA,KAAA,kBAAAA,KAAA,MAAAE,IAAA,GAAAF,KAAA,CAAAG,MAAA,CAAAC,WAAA,OAAAF,IAAA,KAAAG,SAAA,QAAAC,GAAA,GAAAJ,IAAA,CAAAK,IAAA,CAAAP,KAAA,EAAAC,IAAA,2BAAAK,GAAA,sBAAAA,GAAA,YAAAE,SAAA,4DAAAP,IAAA,gBAAAF,MAAA,GAAAU,MAAA,EAAAT,KAAA;AAEjC,MAAMU,kBAAkB,CAAwC;EAC9DC,UAAUA,CAACtB,GAAwB,EAAoB;IAC5D,MAAMuB,OAAO,GAAG,IAAIC,OAAO,CAACxB,GAAG,CAAC;IAEhC,OAAOuB,OAAO;EAChB;AACF;AAACE,OAAA,CAAAJ,kBAAA,GAAAA,kBAAA;AAED,MAAMG,OAAO,CAA6B;EAGxCE,WAAWA,CAAC1B,GAAwB,EAAE;IAAAF,eAAA;IACpC,IAAI,CAAC6B,UAAU,GAAG3B,GAAG;EACvB;EAEA,IAAIA,GAAGA,CAAA,EAAwB;IAC7B,OAAO,IAAI,CAAC2B,UAAU;EACxB;EAEOC,IAAIA,CAAA,EAAmC;IAC5C,MAAMC,IAAI,GAAGC,YAAY,CAACC,OAAO,CAAC,IAAI,CAACJ,UAAU,CAAC;IAElD,IAAI,CAACE,IAAI,EAAE;MACT,OAAO,IAAAG,sBAAG,EACR,IAAIC,iCAAc,CAACC,qCAAkB,CAACC,WAAW,EAAE,IAAI,CAACR,UAAU,CAAC,CACpE;IACH;IAEA,OAAO,IAAAS,qBAAE,EAACP,IAAI,CAAC;EACjB;EAEOQ,KAAKA,CAACR,IAAY,EAAgC;IACvD,IAAI;MACFC,YAAY,CAACQ,OAAO,CAAC,IAAI,CAACX,UAAU,EAAEE,IAAI,CAAC;MAE3C,OAAO,IAAAO,qBAAE,GAAE;IACb,CAAC,CAAC,OAAOG,GAAG,EAAE;MACZ,OAAO,IAAAP,sBAAG,EAAC,IAAIC,iCAAc,CAACC,qCAAkB,CAACM,YAAY,EAAED,GAAG,CAAC,CAAC;IACtE;EACF;AACF"}